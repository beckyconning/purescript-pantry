// Generated by psc version 0.7.1.0
"use strict";
var $foreign = require("./foreign");
var Prelude = require("Prelude");
var Data_Int = require("Data.Int");
var Data_Maybe = require("Data.Maybe");
var Data_Traversable = require("Data.Traversable");
var Data_List = require("Data.List");
var Data_Map = require("Data.Map");
var Data_Set = require("Data.Set");
var Data_Function = require("Data.Function");
var Data_Either = require("Data.Either");
var Data_Tuple = require("Data.Tuple");
var Data_Unfoldable = require("Data.Unfoldable");
var Data_Foldable = require("Data.Foldable");
var JObject = (function () {
    function JObject(value0) {
        this.value0 = value0;
    };
    JObject.create = function (value0) {
        return new JObject(value0);
    };
    return JObject;
})();
var JArray = (function () {
    function JArray(value0) {
        this.value0 = value0;
    };
    JArray.create = function (value0) {
        return new JArray(value0);
    };
    return JArray;
})();
var JString = (function () {
    function JString(value0) {
        this.value0 = value0;
    };
    JString.create = function (value0) {
        return new JString(value0);
    };
    return JString;
})();
var JNumber = (function () {
    function JNumber(value0) {
        this.value0 = value0;
    };
    JNumber.create = function (value0) {
        return new JNumber(value0);
    };
    return JNumber;
})();
var JInt = (function () {
    function JInt(value0) {
        this.value0 = value0;
    };
    JInt.create = function (value0) {
        return new JInt(value0);
    };
    return JInt;
})();
var JBool = (function () {
    function JBool(value0) {
        this.value0 = value0;
    };
    JBool.create = function (value0) {
        return new JBool(value0);
    };
    return JBool;
})();
var JNull = (function () {
    function JNull() {

    };
    JNull.value = new JNull();
    return JNull;
})();
var FromJSON = function (parseJSON) {
    this.parseJSON = parseJSON;
};
var ToJSON = function (toJSON) {
    this.toJSON = toJSON;
};
var $dot$bang$eq = function (pmval) {
    return function (val) {
        return Prelude["<$>"](Data_Either.functorEither)(Data_Maybe.fromMaybe(val))(pmval);
    };
};
var valueToJSONImpl = function (_480) {
    if (_480 instanceof JObject) {
        return $foreign.objToHash(valueToJSONImpl, Data_Tuple.fst, Data_Tuple.snd, Data_List.fromList(Data_Unfoldable.unfoldableArray)(Data_Map.toList(_480.value0)));
    };
    if (_480 instanceof JArray) {
        return $foreign.unsafeCoerce(Prelude["<$>"](Prelude.functorArray)(valueToJSONImpl)(_480.value0));
    };
    if (_480 instanceof JString) {
        return $foreign.unsafeCoerce(_480.value0);
    };
    if (_480 instanceof JNumber) {
        return $foreign.unsafeCoerce(_480.value0);
    };
    if (_480 instanceof JInt) {
        return $foreign.unsafeCoerce(_480.value0);
    };
    if (_480 instanceof JBool) {
        return $foreign.unsafeCoerce(_480.value0);
    };
    if (_480 instanceof JNull) {
        return $foreign.jsNull;
    };
    throw new Error("Failed pattern match: " + [ _480.constructor.name ]);
};
var valueToString = function (v) {
    return $foreign.jsonStringify(valueToJSONImpl(v));
};
var valueToJSON = new ToJSON(Prelude.id(Prelude.categoryFn));
var valueFromJSON = new FromJSON(Data_Either.Right.create);
var unitToJSON = new ToJSON(function (_494) {
    return JNull.value;
});
var toJSON = function (dict) {
    return dict.toJSON;
};
var tupleToJSON = function (__dict_ToJSON_0) {
    return function (__dict_ToJSON_1) {
        return new ToJSON(function (_497) {
            return new JArray([ toJSON(__dict_ToJSON_0)(_497.value0), toJSON(__dict_ToJSON_1)(_497.value1) ]);
        });
    };
};
var $dot$eq = function (__dict_ToJSON_2) {
    return function (name) {
        return function (value) {
            return new Data_Tuple.Tuple(name, toJSON(__dict_ToJSON_2)(value));
        };
    };
};
var stringToJSON = new ToJSON(JString.create);
var showValue = new Prelude.Show(function (_481) {
    if (_481 instanceof JObject) {
        return "JObject " + Prelude.show(Data_Map.showMap(Prelude.showString)(showValue))(_481.value0);
    };
    if (_481 instanceof JArray) {
        return "JArray " + Prelude.show(Prelude.showArray(showValue))(_481.value0);
    };
    if (_481 instanceof JString) {
        return "JString " + Prelude.show(Prelude.showString)(_481.value0);
    };
    if (_481 instanceof JNumber) {
        return "JNumber " + Prelude.show(Prelude.showNumber)(_481.value0);
    };
    if (_481 instanceof JInt) {
        return "JInt " + Prelude.show(Prelude.showInt)(_481.value0);
    };
    if (_481 instanceof JBool) {
        return "JBool " + Prelude.show(Prelude.showBoolean)(_481.value0);
    };
    if (_481 instanceof JNull) {
        return "JNull";
    };
    throw new Error("Failed pattern match: " + [ _481.constructor.name ]);
});
var setToJSON = function (__dict_ToJSON_3) {
    return new ToJSON(function (s) {
        return JArray.create(Data_List.fromList(Data_Unfoldable.unfoldableArray)(Prelude["<$>"](Data_List.functorList)(toJSON(__dict_ToJSON_3))(Data_Set.toList(s))));
    });
};
var parseJSON = function (dict) {
    return dict.parseJSON;
};
var $dot$colon = function (__dict_FromJSON_6) {
    return function (obj) {
        return function (key) {
            var _693 = Data_Map.lookup(Prelude.ordString)(key)(obj);
            if (_693 instanceof Data_Maybe.Nothing) {
                return Data_Either.Left.create("key " + (Prelude.show(Prelude.showString)(key) + " not present"));
            };
            if (_693 instanceof Data_Maybe.Just) {
                return parseJSON(__dict_FromJSON_6)(_693.value0);
            };
            throw new Error("Failed pattern match at /Users/beckyconning/Documents/purescript-pantry/bower_components/purescript-json/src/Data/JSON.purs line 128, column 1 - line 129, column 1: " + [ _693.constructor.name ]);
        };
    };
};
var object = function (ps) {
    return JObject.create(Data_Map.fromList(Prelude.ordString)(Data_List.toList(Data_Foldable.foldableArray)(ps)));
};
var numberToJSON = new ToJSON(JNumber.create);
var maybeToJSON = function (__dict_ToJSON_8) {
    return new ToJSON(function (_496) {
        if (_496 instanceof Data_Maybe.Nothing) {
            return JNull.value;
        };
        if (_496 instanceof Data_Maybe.Just) {
            return toJSON(__dict_ToJSON_8)(_496.value0);
        };
        throw new Error("Failed pattern match at /Users/beckyconning/Documents/purescript-pantry/bower_components/purescript-json/src/Data/JSON.purs line 215, column 1 - line 219, column 1: " + [ _496.constructor.name ]);
    });
};
var maybeFromJSON = function (__dict_FromJSON_9) {
    return new FromJSON(function (a) {
        return Prelude["return"](Data_Either.applicativeEither)((function () {
            var _697 = parseJSON(__dict_FromJSON_9)(a);
            if (_697 instanceof Data_Either.Left) {
                return Data_Maybe.Nothing.value;
            };
            if (_697 instanceof Data_Either.Right) {
                return new Data_Maybe.Just(_697.value0);
            };
            throw new Error("Failed pattern match at /Users/beckyconning/Documents/purescript-pantry/bower_components/purescript-json/src/Data/JSON.purs line 112, column 1 - line 117, column 1: " + [ _697.constructor.name ]);
        })());
    });
};
var $dot$colon$qmark = function (__dict_FromJSON_7) {
    return function (obj) {
        return function (key) {
            var _700 = Data_Map.lookup(Prelude.ordString)(key)(obj);
            if (_700 instanceof Data_Maybe.Nothing) {
                return Prelude["return"](Data_Either.applicativeEither)(Data_Maybe.Nothing.value);
            };
            if (_700 instanceof Data_Maybe.Just) {
                return parseJSON(maybeFromJSON(__dict_FromJSON_7))(_700.value0);
            };
            throw new Error("Failed pattern match at /Users/beckyconning/Documents/purescript-pantry/bower_components/purescript-json/src/Data/JSON.purs line 133, column 1 - line 134, column 1: " + [ _700.constructor.name ]);
        };
    };
};
var mapToJSON = function (__dict_ToJSON_10) {
    return new ToJSON(function (m) {
        return JObject.create(Prelude.map(Data_Map.functorMap)(toJSON(__dict_ToJSON_10))(m));
    });
};
var jsonToValue = function (s) {
    var insert$prime = Data_Map.insert(Prelude.ordString);
    var ctors = {
        "null": JNull.value, 
        number: JNumber.create, 
        "int": JInt.create, 
        bool: JBool.create, 
        string: JString.create, 
        array: JArray.create, 
        object: JObject.create
    };
    var auxes = {
        left: Data_Either.Left.create, 
        right: Data_Either.Right.create, 
        either: Data_Either.either, 
        insert: insert$prime, 
        empty: Data_Map.empty
    };
    return $foreign.jsonParseImpl(Data_Either.Left.create, $foreign.jsonToValueImpl(auxes, ctors), s);
};
var jsonParse = function (s) {
    return $foreign.jsonParseImpl(Data_Either.Left.create, Data_Either.Right.create, s);
};
var intToJSON = new ToJSON(JInt.create);
var fail = Data_Either.Left.create;
var intFromJSON = new FromJSON(function (_486) {
    if (_486 instanceof JInt) {
        return Prelude["return"](Data_Either.applicativeEither)(_486.value0);
    };
    if (_486 instanceof JNumber) {
        return Data_Maybe.maybe(fail(Prelude.show(Prelude.showNumber)(_486.value0) + " is not Int."))(Prelude["return"](Data_Either.applicativeEither))(Data_Int.fromNumber(_486.value0));
    };
    return fail(Prelude.show(showValue)(_486) + " is not Int.");
});
var mapFromJSON = function (__dict_FromJSON_11) {
    return new FromJSON(function (_492) {
        if (_492 instanceof JObject) {
            var fn = function (_493) {
                var _707 = parseJSON(__dict_FromJSON_11)(_493.value1);
                if (_707 instanceof Data_Either.Right) {
                    return Prelude["return"](Data_Either.applicativeEither)(new Data_Tuple.Tuple(_493.value0, _707.value0));
                };
                if (_707 instanceof Data_Either.Left) {
                    return fail(_707.value0);
                };
                throw new Error("Failed pattern match at /Users/beckyconning/Documents/purescript-pantry/bower_components/purescript-json/src/Data/JSON.purs line 123, column 9 - line 126, column 5: " + [ _707.constructor.name ]);
            };
            return Prelude["<$>"](Data_Either.functorEither)(Data_Map.fromList(Prelude.ordString))(Data_Traversable.sequence(Data_List.traversableList)(Data_Either.applicativeEither)(Prelude["<$>"](Data_List.functorList)(fn)(Data_Map.toList(_492.value0))));
        };
        return fail(Prelude.show(showValue)(_492) + " is not (Map String a).");
    });
};
var numberFromJSON = new FromJSON(function (_485) {
    if (_485 instanceof JNumber) {
        return Prelude["return"](Data_Either.applicativeEither)(_485.value0);
    };
    if (_485 instanceof JInt) {
        return Prelude["return"](Data_Either.applicativeEither)(Data_Int.toNumber(_485.value0));
    };
    return fail(Prelude.show(showValue)(_485) + " is not Number.");
});
var stringFromJSON = new FromJSON(function (_488) {
    if (_488 instanceof JString) {
        return Prelude["return"](Data_Either.applicativeEither)(_488.value0);
    };
    return fail(Prelude.show(showValue)(_488) + " is not String.");
});
var tupleFromJSON = function (__dict_FromJSON_12) {
    return function (__dict_FromJSON_13) {
        return new FromJSON(function (_490) {
            if (_490 instanceof JArray && _490.value0.length === 2) {
                return Prelude["<*>"](Data_Either.applyEither)(Prelude["<$>"](Data_Either.functorEither)(Data_Tuple.Tuple.create)(parseJSON(__dict_FromJSON_12)(_490.value0[0])))(parseJSON(__dict_FromJSON_13)(_490.value0[1]));
            };
            return fail(Prelude.show(showValue)(_490) + " is not (a,b).");
        });
    };
};
var unitFromJSON = new FromJSON(function (_487) {
    if (_487 instanceof JNull) {
        return Prelude["return"](Data_Either.applicativeEither)(Prelude.unit);
    };
    return fail(Prelude.show(showValue)(_487) + " is not Null.");
});
var eqValue = new Prelude.Eq(function (_482) {
    return function (_483) {
        if (_482 instanceof JObject && _483 instanceof JObject) {
            return Prelude["=="](Data_Map.eqMap(Prelude.eqString)(eqValue))(_482.value0)(_483.value0);
        };
        if (_482 instanceof JArray && _483 instanceof JArray) {
            return Prelude["=="](Prelude.eqArray(eqValue))(_482.value0)(_483.value0);
        };
        if (_482 instanceof JString && _483 instanceof JString) {
            return Prelude["=="](Prelude.eqString)(_482.value0)(_483.value0);
        };
        if (_482 instanceof JNumber && _483 instanceof JNumber) {
            return _482.value0 === _483.value0;
        };
        if (_482 instanceof JInt && _483 instanceof JInt) {
            return Prelude["=="](Prelude.eqInt)(_482.value0)(_483.value0);
        };
        if (_482 instanceof JBool && _483 instanceof JBool) {
            return Prelude["=="](Prelude.eqBoolean)(_482.value0)(_483.value0);
        };
        if (_482 instanceof JNull && _483 instanceof JNull) {
            return true;
        };
        return false;
    };
});
var encode = function (__dict_ToJSON_14) {
    return function (a) {
        return valueToString(toJSON(__dict_ToJSON_14)(a));
    };
};
var eitherToJSON = function (__dict_ToJSON_15) {
    return function (__dict_ToJSON_16) {
        return new ToJSON(function (_495) {
            if (_495 instanceof Data_Either.Right) {
                return object([ $dot$eq(__dict_ToJSON_16)("Right")(_495.value0) ]);
            };
            if (_495 instanceof Data_Either.Left) {
                return object([ $dot$eq(__dict_ToJSON_15)("Left")(_495.value0) ]);
            };
            throw new Error("Failed pattern match at /Users/beckyconning/Documents/purescript-pantry/bower_components/purescript-json/src/Data/JSON.purs line 208, column 1 - line 212, column 1: " + [ _495.constructor.name ]);
        });
    };
};
var eitherFromJSON = function (__dict_FromJSON_17) {
    return function (__dict_FromJSON_18) {
        return new FromJSON(function (_491) {
            if (_491 instanceof JObject) {
                var _741 = Data_List.fromList(Data_Unfoldable.unfoldableArray)(Data_Map.toList(_491.value0));
                if (_741.length === 1 && (_741[0]).value0 === "Right") {
                    return Prelude["<$>"](Data_Either.functorEither)(Data_Either.Right.create)(parseJSON(__dict_FromJSON_18)((_741[0]).value1));
                };
                if (_741.length === 1 && (_741[0]).value0 === "Left") {
                    return Prelude["<$>"](Data_Either.functorEither)(Data_Either.Left.create)(parseJSON(__dict_FromJSON_17)((_741[0]).value1));
                };
                return fail(Prelude.show(Data_Map.showMap(Prelude.showString)(showValue))(_491.value0) + " is not (Either a b).");
            };
            return fail(Prelude.show(showValue)(_491) + " is not (Either a b).");
        });
    };
};
var eitherDecode = function (__dict_FromJSON_19) {
    return function (s) {
        return Prelude.bind(Data_Either.bindEither)(jsonToValue(s))(function (_30) {
            return parseJSON(__dict_FromJSON_19)(_30);
        });
    };
};
var decode = function (__dict_FromJSON_20) {
    return function (s) {
        var _750 = eitherDecode(__dict_FromJSON_20)(s);
        if (_750 instanceof Data_Either.Right) {
            return new Data_Maybe.Just(_750.value0);
        };
        if (_750 instanceof Data_Either.Left) {
            return Data_Maybe.Nothing.value;
        };
        throw new Error("Failed pattern match at /Users/beckyconning/Documents/purescript-pantry/bower_components/purescript-json/src/Data/JSON.purs line 64, column 1 - line 65, column 1: " + [ _750.constructor.name ]);
    };
};
var boolToJSON = new ToJSON(JBool.create);
var boolFromJSON = new FromJSON(function (_484) {
    if (_484 instanceof JBool) {
        return new Data_Either.Right(_484.value0);
    };
    return fail(Prelude.show(showValue)(_484) + " is not Boolean.");
});
var arrayToJSON = function (__dict_ToJSON_21) {
    return new ToJSON(function (a) {
        return JArray.create(Prelude["<$>"](Prelude.functorArray)(toJSON(__dict_ToJSON_21))(a));
    });
};
var arrayFromJSON = function (__dict_FromJSON_22) {
    return new FromJSON(function (_489) {
        if (_489 instanceof JArray) {
            return Data_Traversable.sequence(Data_Traversable.traversableArray)(Data_Either.applicativeEither)(Prelude["<$>"](Prelude.functorArray)(parseJSON(__dict_FromJSON_22))(_489.value0));
        };
        return fail(Prelude.show(showValue)(_489) + " is not [a].");
    });
};
var setFromJSON = function (__dict_Ord_4) {
    return function (__dict_FromJSON_5) {
        return new FromJSON(function (x) {
            return Prelude["<$>"](Data_Either.functorEither)(Prelude["<$>"](Prelude.functorFn)(Data_Set.fromList(__dict_Ord_4))(Data_List.toList(Data_Foldable.foldableArray)))(parseJSON(arrayFromJSON(__dict_FromJSON_5))(x));
        });
    };
};
module.exports = {
    JObject: JObject, 
    JArray: JArray, 
    JString: JString, 
    JNumber: JNumber, 
    JInt: JInt, 
    JBool: JBool, 
    JNull: JNull, 
    ToJSON: ToJSON, 
    FromJSON: FromJSON, 
    object: object, 
    ".=": $dot$eq, 
    encode: encode, 
    toJSON: toJSON, 
    ".!=": $dot$bang$eq, 
    ".:?": $dot$colon$qmark, 
    ".:": $dot$colon, 
    eitherDecode: eitherDecode, 
    decode: decode, 
    fail: fail, 
    parseJSON: parseJSON, 
    showValue: showValue, 
    eqValue: eqValue, 
    valueFromJSON: valueFromJSON, 
    boolFromJSON: boolFromJSON, 
    numberFromJSON: numberFromJSON, 
    intFromJSON: intFromJSON, 
    unitFromJSON: unitFromJSON, 
    stringFromJSON: stringFromJSON, 
    arrayFromJSON: arrayFromJSON, 
    tupleFromJSON: tupleFromJSON, 
    eitherFromJSON: eitherFromJSON, 
    maybeFromJSON: maybeFromJSON, 
    setFromJSON: setFromJSON, 
    mapFromJSON: mapFromJSON, 
    boolToJSON: boolToJSON, 
    numberToJSON: numberToJSON, 
    intToJSON: intToJSON, 
    stringToJSON: stringToJSON, 
    unitToJSON: unitToJSON, 
    arrayToJSON: arrayToJSON, 
    eitherToJSON: eitherToJSON, 
    mapToJSON: mapToJSON, 
    maybeToJSON: maybeToJSON, 
    setToJSON: setToJSON, 
    tupleToJSON: tupleToJSON, 
    valueToJSON: valueToJSON
};
